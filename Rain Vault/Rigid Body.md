
>[!todo]
>- [x] 驱动虚拟的套管运动
>- [ ] 检测碰撞,没有碰撞的情况下,让真实套管接收处理后的数据
>- [ ] 检测碰撞,发生碰撞的情况下,让真实套管接收处理后的数据




---

## Sequence  
  
从eCAL接收到的tube的数据  
  
>TODO 先转换成世界坐标系下的pos rot,以及自身坐标系的pos rot,这个数据被虚拟套管接收使用  
  
>TODO 虚拟的套管始终被数据驱动,然后在碰撞或者其他条件控制下,把数据进行处理后,传递给真实套管使用.  
  
>TODO 在检测到碰撞发生的时刻,记录此时的Server传递过来的套管数据,然后真实套管就只更新自身坐标系下的Z轴前进后退  
  
>TODO 当虚拟器械拉出去的时候,如果前后晃动了,那么真实套管要跟着动吗,即当发生碰撞后,真实套管要更新的数据,是只有self-Z,还是也会跟着晃动  
  
>TODO 力的计算,就采用套管尖端相减得到向量表示的方式  
  
>TODO 比较重要的问题在于,分解力到两个坐标系上  
  
>TODO 然后通过传输协议,把力发出去  
  
>TODO 可以先借鉴下Unity的实现方式  
  
  
  
## Output & Achieved effect  
  
  
## Problem  
  
In Unity,计算方式是当真实套管也超过碰撞范围的时候,计算超过了多少,然后再给转回去.  
  
我在想,能不能把位姿分解后,就停止更新真实套管的世界坐标系下的位姿,只更新自身坐标系的,前后运动,和绕着支点的晃动,这样好像有问题.貌似是不如Unity的方式的.